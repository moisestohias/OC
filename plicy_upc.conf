map "BEZ" ipaddress files "/pl2/pl2/mpe/maps/BEZ_pool.txt"
map "BKH" ipaddress files "/pl2/pl2/mpe/maps/BKH_pool.txt"
map "ORN" ipaddress files "/pl2/pl2/mpe/maps/ORN_pool.txt"
map "CTN" ipaddress files "/pl2/pl2/mpe/maps/CTN_pool.txt"

function "BEZ"(integer "SessionID") returns boolean "res"
{
  set res = (Map.BEZ.Contains(Session[SessionID].AttributeView.Data.Framed_IP_Address))
} 
function "BKH"(integer "SessionID") returns boolean "res"
{
  set res = (Map.BKH.Contains(Session[SessionID].AttributeView.Data.Framed_IP_Address))
}
function "ORN"(integer "SessionID") returns boolean "res"
{
  set res = (Map.ORN.Contains(Session[SessionID].AttributeView.Data.Framed_IP_Address))
}
function "CTN"(integer "SessionID") returns boolean "res"
{
  set res = (Map.CTN.Contains(Session[SessionID].AttributeView.Data.Framed_IP_Address))
}


# UPC package containing two counters and each counter is associated to a particular
# service in Gy package

package user_plane_controller                                 \
  user_plane_host_group "BezPREs"                             \
  filter_condition "BEZ"                                      \
  user_plane_host_group "BkhPREs"                             \
  filter_condition "BKH"                                      \
  user_plane_host_group "CtnPREs"                             \
  filter_condition "CTN"                                      \
  user_plane_host_group "OrnPREs"                             \
  filter_condition "ORN"                                      \
  key "LOCALIP"                                               \
  column "UnManaged"                                          \
    datatype "boolean"                                        \
  column "RG53_status"                                        \
    datatype "string"                                         \
  column "RG53_URL"                                           \
    datatype "string"                                         \
  column "RG200_status"                                       \
    datatype "string"                                         \
  column "RG200_URL"                                          \
    datatype "string"                                         \
  column "RG300_status"                                       \
    datatype "string"                                         \
  column "RG300_URL"                                          \
    datatype "string"                                         \
  column "RG513_status"                                       \
    datatype "string"                                         \
  column "RG513_URL"                                          \
    datatype "string"                                         \
  column "RG521_status"                                       \
    datatype "string"                                         \
  column "RG521_URL"                                          \
    datatype "string"                                         \
  column "RG522_status"                                       \
    datatype "string"                                         \
  column "RG522_URL"                                          \
    datatype "string"                                         \
  column "RG509_status"                                       \
    datatype "string"                                         \
  column "RG509_URL"                                          \
    datatype "string"                                         \
  column "RG524_status"                                       \
    datatype "string"                                         \
  column "RG524_URL"                                          \
    datatype "string"                                         \
  column "RG527_status"                                       \
    datatype "string"                                         \
  column "RG527_URL"                                          \
    datatype "string"                                         \
  column "RG528_status"                                       \
    datatype "string"                                         \
  column "RG528_URL"                                          \
    datatype "string"                                         \
  column "RG530_status"                                       \
    datatype "string"                                         \
  column "RG530_URL"                                          \
    datatype "string"                                         \
  column "RG531_status"                                       \
    datatype "string"                                         \
  column "RG531_URL"                                          \
    datatype "string"                                         \
  column "RG540_status"                                       \
    datatype "string"                                         \
  column "RG540_URL"                                          \
    datatype "string"                                         \
  column "RG541_status"                                       \
    datatype "string"                                         \
  column "RG541_URL"                                          \
    datatype "string"                                         \
  column "RG532_status"                                       \
    datatype "string"                                         \
  column "RG532_URL"                                          \
    datatype "string"                                         \
  column "internet_service_qos"                               \
    datatype "integer"                                        \
  column "facebook_qos"                                       \
    datatype "integer"                                        \
  column "pubg_qos"                                           \
    datatype "integer"                                        \
  column "youtube_qos"                                        \
    datatype "integer"                                        \
  column "whatsapp_qos"                                       \
    datatype "integer"                                        \
  column "instagram_qos"                                      \
    datatype "integer"                                        \
  column "snapchat_qos"                                       \
    datatype "integer"                                        \
  column "tiktok_qos"                                         \
    datatype "integer"                                        \
  column "anazik_qos"                                         \
    datatype "integer"                                        \
  column "max_ul_qos"                                         \
    datatype "integer"                                        \
  column "max_dl_qos"                                         \
    datatype "integer"                                        \
  column "chargingRuleBaseName"                               \
    datatype "string"                                         \
  column "isVpnUser"                                          \
    datatype "boolean"                                        \
  subscriber "true"                                           \
  column "isPsiohonHost"                                      \
    datatype "boolean"                                        \
  column "NAS_IP"                                             \
    datatype "ipaddress"                                      \
  column "isIntercepted"                                      \
    datatype "boolean"                                        \
    subscriber "true"                                          \
  column "action"                                             \
    datatype "string"                                         \
    subscriber "true"                                          \
  column "mobileCity"                                         \
    datatype "string"                                         \
  column "mobileArea"                                         \
    datatype "string"                                         \
  column "mobileCell"                                         \
    datatype "string"                                         \
  column "mobileSite"                                         \
    datatype "string"                                         \
  column "tethered_all_qos"                                   \
    datatype "integer"                                        \
  column "tethered_youtube_qos"                               \
    datatype "integer"                                        \
  column "tethering_status"                                   \
    datatype "string"                                         \
  column "parental_control_status"                            \
    datatype "string"                                         \
  column "cellAction"                                         \
    datatype "string"                                         \
  counter "1"                                                 \
    match_condition "/ShapingObjects/DNS_rule_all"            \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  counter "2"                                                 \
    match_condition "/ShapingObjects/DNS_pass"                \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  counter "28"                                                \
    match_condition "/ShapingObjects/internet_ANY_rule"       \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  counter "6"                                                 \
    match_condition "/ShapingObjects/ANY_Roaming"             \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  counter "48"                                                \
    match_condition "/ShapingObjects/ooredoowap_ANY_rule"     \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  counter "36"                                                \
    match_condition "/ShapingObjects/HTTP"                    \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  counter "35"                                                \
    match_condition "/ShapingObjects/AGB"                     \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  counter "34"                                                \
    match_condition "/ShapingObjects/page_light"              \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  counter "32"                                                \
    match_condition "/ShapingObjects/gameloft"                \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  counter "43"                                                \
    match_condition "/ShapingObjects/learning"                \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  counter "26"                                                \
    match_condition "/ShapingObjects/ospace"                  \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  counter "25"                                                \
    match_condition "/ShapingObjects/ospace_free"             \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  counter "24"                                                \
    match_condition "/ShapingObjects/cupertino"               \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  counter "23"                                                \
    match_condition "/ShapingObjects/ooklo_ooredoo"           \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  counter "22"                                                \
    match_condition "/ShapingObjects/VPN_rule"                \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  counter "53"                                                \
    match_condition "/ShapingObjects/All_Youtube"             \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  counter "52"                                                \
    match_condition "/ShapingObjects/All_WhatsApp"            \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  counter "59"                                                \
    match_condition "/ShapingObjects/All_Instagram"           \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  counter "71"                                                \
    match_condition "/ShapingObjects/All_PubG"                \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  counter "13"                                                \
    match_condition "/ShapingObjects/tariki"                  \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  counter "58"                                                \
    match_condition "/ShapingObjects/All_Facebook"            \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  counter "21"                                                \
    match_condition "/ShapingObjects/FB_free_Header"          \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  counter "17"                                                \
    match_condition "/ShapingObjects/FB_free"                 \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  counter "45"                                                \
    match_condition "/ShapingObjects/ooredoomms_rule"         \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  counter "12"                                                \
    match_condition "/ShapingObjects/WAP_9201"                \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  counter "69"                                                \
    match_condition "/ShapingObjects/Guatemala"               \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  counter "67"                                                \
    match_condition "/ShapingObjects/snapchat"                \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  counter "70"                                                \
    match_condition "/ShapingObjects/Anazik_Rule"             \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  counter "73"                                                \
    match_condition "/ShapingObjects/Youtube_pcrf_512"        \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \                                         
  counter "74"                                                \
    match_condition "/ShapingObjects/tiktok_512"              \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  counter "75"                                                \
    match_condition "/ShapingObjects/P2P_128"                 \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  counter "76"                                                \
    match_condition "/ShapingObjects/pr_tiktok"               \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  counter "77"                                                \
    match_condition "/ShapingObjects/so_Astra_free"           \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  counter "78"                                                \
    match_condition "/ShapingObjects/shahid_541"              \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  counter "8"                                                 \
    match_condition "/ShapingObjects/ooredooptt"              \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  counter "3"                                                 \
    match_condition "/ShapingObjects/so_being_analyzed_all"   \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  counter "79"                                                \
    match_condition "/ShapingObjects/ooredoonbs"              \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  counter "80"                                                \
    match_condition "/ShapingObjects/OsnAnghami_532"          \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  counter "38"                                                \
    match_condition "/ShapingObjects/Go_Play_Market"          \
    report_after_ms "30000"                                   \
    report_after_bytes "1000000"                              \
  column "IsExamCenterArea"                                   \
    datatype "boolean"                                        \
    subscriber "true"                                         \
